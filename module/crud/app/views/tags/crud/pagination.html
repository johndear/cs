%{ nbPages = _caller.count.page(controllers.CRUD.getPageSize()) }%


#{if nbPages > 1}
    <div class="vertical-align:center;">
		
		<div style="float:left;padding-left:15px;">${controllers.CRUD.getPageSize()}条/页, 总共${_caller.count}条, 共${nbPages}页</div>
        <ul class="pagination pull-right">
        %{
            limit = (_limit != null ? _limit : 10)
            start = _caller.page - (int)(limit/2) + (limit % 2 ? 0 : 1)
            end = _caller.page + (int)(limit/2)

            if(start < 1){
                extra = 1 - start
                end = (end + extra < nbPages ? end + extra : nbPages)
                start = 1
            }else if(end > nbPages){
                extra = end - nbPages
                start = (start - extra > 1 ? start - extra : 1)
                end = nbPages
            }
        }%

        #{if _caller.page > 1}
            <li>
            	<a onclick="submitByPage(${_caller.page-1})">&{'crud.pagination.previous'}</a>
                <!-- #{a @list().add('page', _caller.page-1).add('search', _caller.params.search).add('orderBy', _caller.orderBy).add('order', _caller.order)}&{'crud.pagination.previous'}#{/a} -->
            </li>
        #{/if}

        #{if start > 1}
            <li>
            	<a onclick="submitByPage(1)">&{'crud.pagination.first'}</a>
                <!-- #{a @list().add('page', 1).add('search', _caller.params.search).add('orderBy', _caller.orderBy).add('order', _caller.order)}&{'crud.pagination.first'}#{/a} -->
            </li>
        #{/if}

        %{ for (i in start..end) { }%
            <li>
                #{if _caller.page == i}
                	<a onclick="submitByPage(${i})"><b>${i}</b></a>
                    <!-- #{a @list().add('page', i).add('search', _caller.params.search).add('orderBy', _caller.orderBy).add('order', _caller.order)}<b>${i}</b>#{/a} -->
                #{/if}
                #{else}
                	<a onclick="submitByPage(${i})">${i}</a>
                    <!-- #{a @list().add('page', i).add('search', _caller.params.search).add('orderBy', _caller.orderBy).add('order', _caller.order)}${i}#{/a} -->
                #{/else}
            </li>
        %{ } }%

        #{if end < nbPages}
            <li>
            	<a onclick="submitByPage(${nbPages})">&{'crud.pagination.last'}</a>
                <!-- #{a @list().add('page', nbPages).add('search', _caller.params.search).add('orderBy', _caller.orderBy).add('order', _caller.order)}&{'crud.pagination.last'}#{/a} -->
            </li>
        #{/if}

        #{if _caller.page < nbPages}
            <li>
            	<a onclick="submitByPage(${_caller.page+1})">&{'crud.pagination.next'}</a>
                <!-- #{a @list().add('page', _caller.page+1).add('search', _caller.params.search).add('orderBy', _caller.orderBy).add('order', _caller.order)}&{'crud.pagination.next'}#{/a} -->
            </li>
        #{/if}
		
        </ul>
		
    </div>

#{/if}
